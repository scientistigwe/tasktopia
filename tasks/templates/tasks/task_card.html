{% load static %}
<li class="card mb-1">
    <span class="task-detail-icon d-flex align-self-end position-absolute">
        <a href="{% url 'task_details' task.pk %}">
            <img src="{% static 'tasks/img/task-detail.png' %}" alt="task details icon" width="20" height="20">
        </a>
    </span>
    <span
        class="col-12 card-title {% if task.status == 'Overdue' %}task-overdue{% elif task.status == 'In Progress' %}task-in-progress{% elif task.status == 'Completed' %}task-completed{% else %}task-pending{% endif %}">
        {{ task.title }}
    </span>
    <span class="col-12 card-text">{{ task.description }}</span>
    <span class="row">
        {% if task.status == 'In Progress' %}
        <span class="col-4">Start: {{ task.start_date|date:"M d, Y" }}</span>
        {% endif %}
        <span class="col-4">Due: {{ task.due_date|date:"M d, Y" }}</span>
        <span
            class="col-4 {% if task.status == 'Overdue' %}task-overdue{% elif task.status == 'In Progress' %}task-in-progress{% elif task.status == 'Completed' %}task-completed{% else %}task-pending{% endif %}">
            {{ task.get_priority_display }}
        </span>
        <span class="col-4">Category: {{ task.category }}</span>
    </span>
    {% if task.status == 'Completed' %}
    <span class="col-4">Completed: {{ task.updated_at|date:"M d, Y" }}</span>
    {% elif task.status == 'Overdue' %}
    <span class="col-12 task-overdue">Overdue</span>
    {% endif %}

    <!-- Form with Bootstrap switch -->
    <form action="{% url 'mark_completed' task.pk %}" method="post" class="form-inline">
        {% csrf_token %}
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="completedSwitch{{ task.id }}" name="completed"
                onChange="this.form.submit()" {% if task.status=='Completed' %}checked{% endif %}>
            <label class="form-check-label" for="completedSwitch{{ task.id }}">Mark as Completed</label>
        </div>
    </form>
</li>